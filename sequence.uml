@startuml

participant Пользователь
participant Приложение
participant Бэкенд

Alt Присутствует соединение к сети Интернет

Alt Обсуждение под выбранным сообщением не было создано

    Пользователь -> Приложение: Создание обсуждения
    Activate Приложение
    Приложение -> Бэкенд: Запрос на создание обсуждения
    Activate Бэкенд

    Приложение <-- Бэкенд: Ответ на запрос
    Deactivate Бэкенд

    Пользователь <-- Приложение: Отображение созданного обсуждения

    else Обсуждение под выбранным комментарием уже было создано

    Пользователь -> Приложение: Развернуть ветку обсуждения
    Пользователь <-- Приложение: Развёрнутая ветка обсуждения

end

Alt Пользователь желает оставить комментарий


    Alt Набор текстового комменатрия

    Пользователь -> Приложение: Набор текстового комментария

    else Ввод недопустимого количества символов в текстовое поле
    
    loop До тех пор, пока пользователь не введёт допустимое количество символов
    Пользователь -> Приложение: Набор текстового комментария
    Пользователь <-- Приложение: Отображение ошибки
    end

    else Загрузка аудио/видеосообщения

    ref over Пользователь, Приложение, Бэкенд: Отправка аудио/видеосообщений
    end

    Пользователь -> Приложение: Отправление комментария
    Activate Приложение #FFBBBB

    Приложение -> Бэкенд: Запрос на оставление комментария
    Activate Бэкенд

    Приложение <-- Бэкенд: Ответ на запрос
    Deactivate Бэкенд
    
    Alt Комментарий оставлен до удаления обсуждения

    Пользователь <-- Приложение: Отображение комментария

    else Комментарий оставлен после удаления обсуждения
    Пользователь <-- Приложение: Отображение ошибки
    Deactivate Приложение

    end

    else Пользователь желает не оставлять комментарий и свернуть ветку
    Пользователь -> Приложение: Свернуть ветку обсуждения
    Пользователь <-- Приложение: Свёрнутая ветка обсуждения

    else Пользователь желает удалить комментарий
    ref over Пользователь, Приложение, Бэкенд: Удаление комментария

    else Пользователь желает удалить сообщение вместе с обсуждением
    ref over Пользователь, Приложение, Бэкенд: Удаление сообщения



end


else Отсутствует подключение к сети Интернет
Пользователь <-- Приложение: Ошибка подключения
end

Deactivate Приложение

@enduml
